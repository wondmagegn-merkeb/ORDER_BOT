<div class="container mx-auto px-4 py-6">
  <h1 class="text-3xl font-bold text-center mb-8 text-gray-800 flex justify-center items-center">
    <!-- Icon Added Here -->
    <i class="fas fa-cogs mr-3 text-blue-600"></i>
    Admin Management
  </h1>

  <!-- Search and Add -->
  <div class="flex justify-between items-center mb-6">
    <div class="relative w-full max-w-md">
      <input type="text" id="searchInput" placeholder="Search by ID, Username, Role or Status"
        class="w-full p-2 pl-10 border border-gray-300 rounded">
      <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
    </div>

    <a href="/admin/add" class="ml-4 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition inline-flex items-center gap-2">
      <i class="fas fa-plus"></i> Add
    </a>
  </div>

  <!-- Filter by Role and Status -->
  <div class="mb-6">
    <button id="adminFilterBtn" class="px-4 py-2 rounded bg-blue-500 text-white hover:bg-blue-600 mr-2">Admin</button>
    <button id="deliveryBoyFilterBtn" class="px-4 py-2 rounded bg-blue-500 text-white hover:bg-blue-600 mr-2">Delivery Boy</button>
    <button id="managerFilterBtn" class="px-4 py-2 rounded bg-blue-500 text-white hover:bg-blue-600 mr-2">Manager</button>
    <button id="activeFilterBtn" class="px-4 py-2 rounded bg-green-500 text-white hover:bg-green-600 mr-2">Active</button>
    <button id="inactiveFilterBtn" class="px-4 py-2 rounded bg-red-500 text-white hover:bg-red-600">Inactive</button>
  </div>

  <!-- Admin Table -->
  <table class="min-w-full bg-white border border-gray-300 rounded-md shadow-md">
    <thead>
      <tr>
        <th class="p-3 border-b text-left">Admin ID</th>
        <th class="p-3 border-b text-left">Username</th>
        <th class="p-3 border-b text-left">Email</th>
        <th class="p-3 border-b text-left">Role</th>
        <th class="p-3 border-b text-left">Status</th>
        <th class="p-3 border-b text-left">Actions</th>
      </tr>
    </thead>
    <tbody id="adminTableBody">
      <% admins.forEach(admin => { %>
        <tr>
          <td class="p-3 border-b"><%= admin.adminId %></td>
          <td class="p-3 border-b"><%= admin.username %></td>
          <td class="p-3 border-b"><%= admin.email %></td>
          <td class="p-3 border-b"><%= admin.role %></td>
          <td class="p-3 border-b"><%= admin.states %></td>
          <td class="p-3 border-b flex space-x-2">
            <a href="/admin/edit/<%= admin.adminId %>" class="text-yellow-500 hover:text-yellow-600">
              <i class="fas fa-edit"></i> Update
            </a>
            <form method="POST" class="delete-form inline" data-id="<%= admin.adminId %>" data-action="/admin/delete">
              <button type="button" class="open-delete-modal text-red-500 hover:text-red-600">
                <i class="fas fa-trash-alt"></i> Delete
              </button>
            </form>
          </td>
        </tr>
      <% }); %>
    </tbody>
  </table>

  <!-- Pagination -->
  <div class="mt-6 flex justify-center items-center space-x-2" id="paginationContainer">
    <!-- Pagination buttons will be added by JS -->
  </div>
</div>

<script>
  const searchInput = document.getElementById('searchInput');
  const adminTableBody = document.getElementById('adminTableBody');
  const rows = Array.from(adminTableBody.getElementsByTagName('tr'));
  const paginationContainer = document.getElementById('paginationContainer');

  const rowsPerPage = 5;
  let currentPage = 1;

  // Search functionality
  searchInput.addEventListener('input', function () {
    const searchQuery = this.value.toLowerCase();
    rows.forEach(row => {
      const id = row.cells[0].textContent.toLowerCase();
      const username = row.cells[1].textContent.toLowerCase();
      const role = row.cells[3].textContent.toLowerCase();
      const status = row.cells[4].textContent.toLowerCase();
      row.style.display = (id.includes(searchQuery) || username.includes(searchQuery) || role.includes(searchQuery) || status.includes(searchQuery)) ? '' : 'none';
    });
  });

  // Filter by role and status functionality
  document.getElementById('adminFilterBtn').addEventListener('click', () => filterAdmins('admin'));
  document.getElementById('deliveryBoyFilterBtn').addEventListener('click', () => filterAdmins('delivery boy'));
  document.getElementById('managerFilterBtn').addEventListener('click', () => filterAdmins('manager'));
  document.getElementById('activeFilterBtn').addEventListener('click', () => filterAdmins('active'));
  document.getElementById('inactiveFilterBtn').addEventListener('click', () => filterAdmins('inactive'));

  function filterAdmins(filterValue) {
    rows.forEach(row => {
      const role = row.cells[3].textContent.toLowerCase();
      const status = row.cells[4].textContent.toLowerCase();
      row.style.display = (role.includes(filterValue) || status.includes(filterValue)) ? '' : 'none';
    });
  }

  // Pagination rendering
  function displayPage(page) {
    const start = (page - 1) * rowsPerPage;
    const end = start + rowsPerPage;

    rows.forEach((row, index) => {
      row.style.display = (index >= start && index < end) ? '' : 'none';
    });

    renderPagination();
  }

  function renderPagination() {
    paginationContainer.innerHTML = '';
    const totalPages = Math.ceil(rows.length / rowsPerPage);

    // First page button
    const firstPageBtn = document.createElement('button');
    firstPageBtn.innerHTML = '&laquo;';
    firstPageBtn.className = `px-4 py-2 rounded-md border text-sm ${
      currentPage === 1 ? 'bg-gray-300 cursor-not-allowed' : 'bg-white text-gray-700 border-gray-300 hover:bg-blue-100'
    }`;
    firstPageBtn.disabled = currentPage === 1;
    firstPageBtn.addEventListener('click', () => {
      if (currentPage !== 1) {
        currentPage = 1;
        displayPage(currentPage);
      }
    });
    paginationContainer.appendChild(firstPageBtn);

    // Previous page button
    const prevPageBtn = document.createElement('button');
    prevPageBtn.innerHTML = '&lsaquo;';
    prevPageBtn.className = `px-4 py-2 rounded-md border text-sm ${
      currentPage === 1 ? 'bg-gray-300 cursor-not-allowed' : 'bg-white text-gray-700 border-gray-300 hover:bg-blue-100'
    }`;
    prevPageBtn.disabled = currentPage === 1;
    prevPageBtn.addEventListener('click', () => {
      if (currentPage > 1) {
        currentPage--;
        displayPage(currentPage);
      }
    });
    paginationContainer.appendChild(prevPageBtn);

    // Page number buttons
    for (let i = 1; i <= totalPages; i++) {
      const btn = document.createElement('button');
      btn.textContent = i;
      btn.className = `px-4 py-2 rounded-md text-sm border ${
        i === currentPage
          ? 'bg-blue-500 text-white border-blue-500'
          : 'bg-white text-gray-700 border-gray-300 hover:bg-blue-100'
      }`;

      btn.addEventListener('click', () => {
        currentPage = i;
        displayPage(currentPage);
      });
      paginationContainer.appendChild(btn);
    }

    // Next page button
    const nextPageBtn = document.createElement('button');
    nextPageBtn.innerHTML = '&rsaquo;';
    nextPageBtn.className = `px-4 py-2 rounded-md border text-sm ${
      currentPage === totalPages ? 'bg-gray-300 cursor-not-allowed' : 'bg-white text-gray-700 border-gray-300 hover:bg-blue-100'
    }`;
    nextPageBtn.disabled = currentPage === totalPages;
    nextPageBtn.addEventListener('click', () => {
      if (currentPage < totalPages) {
        currentPage++;
        displayPage(currentPage);
      }
    });
    paginationContainer.appendChild(nextPageBtn);

    // Last page button
    const lastPageBtn = document.createElement('button');
    lastPageBtn.innerHTML = '&raquo;';
    lastPageBtn.className = `px-4 py-2 rounded-md border text-sm ${
      currentPage === totalPages ? 'bg-gray-300 cursor-not-allowed' : 'bg-white text-gray-700 border-gray-300 hover:bg-blue-100'
    }`;
    lastPageBtn.disabled = currentPage === totalPages;
    lastPageBtn.addEventListener('click', () => {
      if (currentPage !== totalPages) {
        currentPage = totalPages;
        displayPage(currentPage);
      }
    });
    paginationContainer.appendChild(lastPageBtn);
  }

  // Init
  displayPage(currentPage);
</script>
