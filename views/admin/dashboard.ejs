<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- TailwindCSS -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  
  <!-- FontAwesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  
  <!-- AOS (Animation on Scroll) Library -->
  <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body class="bg-gray-100 p-6" onload="AOS.init()">
<% dailyRevenue.forEach(user => { %>
                <li class="text-lg"><%= user.date %> - <%= user.totalRevenue %> Orders</li>
            <% }) %>
          </ul>
<ul class="space-y-2">
      
<% monthlyRevenue.forEach(user => { %>
                <li class="text-lg"><%= user.month %> - <%= user.orderCount %> Orders</li>
            <% }) %>
          </ul>
<ul class="space-y-2">
      
<% mostOrderedThisWeek.forEach(user => { %>
                <li class="text-lg"><%= user.foodId %> - <%= user.orderCount %> Orders</li>
            <% }) %>
          </ul>
<ul class="space-y-2">
      
<% mostOrderedThisMonth.forEach(user => { %>
                <li class="text-lg"><%= user.foodId %> - <%= user.orderCount %> Orders</li>
            <% }) %>
          </ul>
  <!-- Top KPIs -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    <!-- Total Users -->
    <div class="bg-blue-500 p-4 rounded-xl shadow-lg flex items-center justify-between h-32 text-white transition-transform transform hover:scale-105 hover:shadow-2xl" data-aos="fade-up">
      <div class="flex items-center space-x-4">
        <i class="fas fa-users fa-2x"></i>
        <div>
          <h3 class="text-md font-semibold">Total Users</h3>
          <p class="text-2xl font-bold"><%= totalUsers %></p>
        </div>
      </div>
    </div>

    <!-- Total Orders -->
    <div class="bg-green-500 p-4 rounded-xl shadow-lg flex items-center justify-between h-32 text-white transition-transform transform hover:scale-105 hover:shadow-2xl" data-aos="fade-up" data-aos-delay="100">
      <div class="flex items-center space-x-4">
        <i class="fas fa-shopping-cart fa-2x"></i>
        <div>
          <h3 class="text-md font-semibold">Total Orders</h3>
          <p class="text-2xl font-bold"><%= totalOrders %></p>
        </div>
      </div>
    </div>

    <!-- Total Revenue -->
    <div class="bg-yellow-400 p-4 rounded-xl shadow-lg flex items-center justify-between h-32 text-white transition-transform transform hover:scale-105 hover:shadow-2xl" data-aos="fade-up" data-aos-delay="200">
      <div class="flex items-center space-x-4">
        <i class="fas fa-dollar-sign fa-2x"></i>
        <div>
          <h3 class="text-md font-semibold">Total Revenue</h3>
          <p class="text-2xl font-bold">ETB <%= totalRevenue %></p>
        </div>
      </div>
    </div>

    <!-- Active Users -->
    <div class="bg-indigo-500 p-4 rounded-xl shadow-lg flex items-center justify-between h-32 text-white transition-transform transform hover:scale-105 hover:shadow-2xl" data-aos="fade-up" data-aos-delay="300">
      <div class="flex items-center space-x-4">
        <i class="fas fa-user-check fa-2x"></i>
        <div>
          <h3 class="text-md font-semibold">Active Users: <span class="text-xl font-bold"><%= totalOnlineUsers %> (<%= ((totalOnlineUsers / totalUsers) * 100).toFixed(1) %>%)</span></h3>
          <h3 class="text-md font-semibold">Orders Users: <span class="text-xl font-bold"><%= usersWithOrders %> (<%= ((usersWithOrders / totalUsers) * 100).toFixed(1) %>%)</span></h3>
        </div>
      </div>
    </div>
  </div>
 <!-- Additional KPIs -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
    <!-- New Customers -->
    <div class="bg-pink-500 p-4 rounded-xl shadow-lg flex items-center justify-between h-auto text-white transition-transform transform hover:scale-105 hover:shadow-2xl" data-aos="fade-up">
      <div class="flex items-center space-x-4">
        <i class="fas fa-user-plus fa-2x"></i>
        <div>
          <h3 class="text-md font-semibold">New Customers</h3>
          <p class="text-lg">This Week: <%= newCustomersThisWeek %>, This Month: <%= newCustomersThisMonth %></p>
        </div>
      </div>
    </div>

    <!-- Average Order Value -->
    <div class="bg-purple-500 p-4 rounded-xl shadow-lg flex items-center justify-between h-auto text-white transition-transform transform hover:scale-105 hover:shadow-2xl" data-aos="fade-up" data-aos-delay="100">
      <div class="flex items-center space-x-4">
        <i class="fas fa-chart-line fa-2x"></i>
        <div>
          <h3 class="text-md font-semibold">Average Order Value</h3>
          <p class="text-lg">Min: ETB <%= minOrderValue %></p>
          <p class="text-lg">Max: ETB <%= maxOrderValue %></p>
          <p class="text-lg font-bold">Avg: ETB <%= avgOrderValue %></p>
        </div>
      </div>
    </div>

    <!-- Orders by Status -->
    <div class="bg-red-500 p-4 rounded-xl shadow-lg flex items-center justify-between h-auto text-white transition-transform transform hover:scale-105 hover:shadow-2xl" data-aos="fade-up" data-aos-delay="200">
      <div class="flex items-center space-x-4">
        <i class="fas fa-tasks fa-2x"></i>
        <div>
          <h3 class="text-md font-semibold">Orders Status</h3>
          <div>
            <!-- Pending Status -->
        <p class="text-lg">
          <i class="fas fa-clock mr-2"></i> Pending: <%= pending %>
        </p>
        <!-- In Progress Status -->
        <p class="text-lg">
          <i class="fas fa-spinner mr-2"></i> In Progress: <%= progress %>
        </p>
        <!-- Completed Status -->
        <p class="text-lg">
          <i class="fas fa-check-circle mr-2"></i> Completed: <%= completed %>
        </p>
        <!-- Cancelled Status -->
        <p class="text-lg">
          <i class="fas fa-times-circle mr-2"></i> Cancelled: <%= cancelled %>
        </p>
        <!-- Delivered Status -->
        <p class="text-lg">
          <i class="fas fa-truck mr-2"></i> Delivered: <%= delivered %>
        </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Top Users and Feedback -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
    <!-- Top Users -->
    <div class="bg-green-400 p-4 rounded-xl shadow-lg flex items-center justify-between h-auto text-white transition-transform transform hover:scale-105 hover:shadow-2xl" data-aos="fade-up">
      <div class="flex items-center space-x-4">
        <i class="fas fa-user-tie fa-2x"></i>
        <div>
          <h3 class="text-md font-semibold">Top Users</h3>
          <ul class="space-y-2">
    
<% topUsers.forEach(user => { %>
                <li class="text-lg"><%= user.fullName %>(<%= user.userId %>) - <%= user.orderCount %> Orders</li>
            <% }) %>
          </ul>
        </div>
      </div>
    </div>

    <!-- User Feedback -->
    <div class="bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-600 p-6 rounded-xl shadow-lg transition-transform transform hover:scale-105 hover:shadow-2xl" data-aos="fade-up" data-aos-delay="300">
      <div class="flex items-center space-x-4">
        <i class="fas fa-comment-alt fa-2x text-white"></i>
        <div>
          <h3 class="text-lg font-semibold text-white flex items-center">
            User Feedback
          </h3>
          <ul class="space-y-3 mt-4 text-white">
          
  <!-- Tasty feedback -->
  <li class="text-lg">
    <i class="mr-2">üòã</i> Tasty: <%= tastyCount %> 
  </li>

  <!-- Love feedback -->
  <li class="text-lg">
    <i class="mr-2">üòç</i> Loved it: <%= loveCount %> 
  </li>

  <!-- Delicious feedback -->
  <li class="text-lg">
    <i class="mr-2">üçΩÔ∏è</i> Delicious: <%= deliciousCount %> 
  </li>

  <!-- Good feedback -->
  <li class="text-lg">
    <i class="mr-2">üòä</i> It was good: <%= goodCount %> 
  </li>

  <!-- Okay feedback -->
  <li class="text-lg">
    <i class="mr-2">üëå</i> Okay: <%= okayCount %> 
  </li>

  <!-- Bad feedback -->
  <li class="text-lg">
    <i class="mr-2">üòû</i> Not happy: <%= badCount %> 
  </li>

          </ul>
        </div>
      </div>
    </div>
  </div>
  
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
    <div class="bg-blue-100 p-6 rounded-xl shadow-lg text-white transition-transform transform hover:scale-105 hover:shadow-2xl" data-aos="fade-up">
      <h3 class="text-lg font-semibold mb-4 text-black">Most Ordered Items (This Week)</h3>
      <canvas id="weekPieChart"></canvas>
    </div>

    <div class="bg-green-100 p-6 rounded-xl shadow-lg text-white transition-transform transform hover:scale-105 hover:shadow-2xl" data-aos="fade-up" data-aos-delay="100">
      <h3 class="text-lg font-semibold mb-4 text-black">Most Ordered Items (This Month)</h3>
      <canvas id="monthPieChart"></canvas>
    </div>
  </div>
  <!-- Revenue Line Charts -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 gap-6 mb-8">
    <!-- Daily Revenue Line Chart -->
    <div class="bg-blue-100 p-6 rounded-xl shadow-lg text-white transition-transform transform hover:scale-105 hover:shadow-2xl" data-aos="fade-up">
      <h3 class="text-lg font-semibold mb-4 text-black">Daily Revenue</h3>
      <canvas id="dailyRevenueLineChart"></canvas>
    </div>

    <!-- Monthly Revenue Line Chart -->
    <div class="bg-green-100 p-6 rounded-xl shadow-lg text-white transition-transform transform hover:scale-105 hover:shadow-2xl" data-aos="fade-up" data-aos-delay="100">
      <h3 class="text-lg font-semibold mb-4 text-black">Monthly Revenue</h3>
      <canvas id="monthlyRevenueLineChart"></canvas>
    </div>
  </div>

  <!-- Order Status Bar Charts -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 gap-6 mb-8">
    <!-- Daily Order Status Bar Chart -->
    <div class="bg-yellow-100 p-6 rounded-xl shadow-lg text-white transition-transform transform hover:scale-105 hover:shadow-2xl" data-aos="fade-up">
      <h3 class="text-lg font-semibold mb-4 text-black">Daily Order Status</h3>
      <canvas id="dailyOrderStatusBarChart"></canvas>
    </div>

    <!-- Monthly Order Status Bar Chart -->
    <div class="bg-red-100 p-6 rounded-xl shadow-lg text-white transition-transform transform hover:scale-105 hover:shadow-2xl" data-aos="fade-up" data-aos-delay="100">
      <h3 class="text-lg font-semibold mb-4 text-black">Monthly Order Status</h3>
      <canvas id="monthlyOrderStatusBarChart"></canvas>
    </div>
  </div>

  <!-- Order Count Bar Charts -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 gap-6 mb-8">
    <!-- Daily Order Count Bar Chart -->
    <div class="bg-purple-100 p-6 rounded-xl shadow-lg text-white transition-transform transform hover:scale-105 hover:shadow-2xl" data-aos="fade-up">
      <h3 class="text-lg font-semibold mb-4 text-black">Daily Order Count</h3>
      <canvas id="dailyOrderCountBarChart"></canvas>
    </div>

    <!-- Monthly Order Count Bar Chart -->
    <div class="bg-indigo-50 p-6 rounded-xl shadow-lg text-white transition-transform transform hover:scale-105 hover:shadow-2xl" data-aos="fade-up" data-aos-delay="100">
      <h3 class="text-lg font-semibold mb-4 text-black">Monthly Order Count</h3>
      <canvas id="monthlyOrderCountBarChart"></canvas>
    </div>
  </div>
<!-- Present Orders Table -->
<div class="bg-white p-6 rounded-xl shadow-lg mb-8">
  <h3 class="text-lg font-semibold mb-4 text-black">Present Orders</h3>
  <table class="min-w-full bg-gray-100 border border-gray-200 rounded-lg overflow-hidden">
    <thead>
      <tr class="bg-blue-500 text-white">
        <th class="py-3 px-4 text-left">Order ID</th>
        <th class="py-3 px-4 text-left">User</th>
        <th class="py-3 px-4 text-left">Status</th>
        <th class="py-3 px-4 text-left">Total Price (ETB)</th>
        <th class="py-3 px-4 text-left">Date</th>
      </tr>
    </thead>
    <tbody>
      <% orders.forEach(order => { %>
        <tr class="hover:bg-gray-200">
          <td class="py-3 px-4">#<%= order.orderId %></td>
          <td class="py-3 px-4"><%= order.User.fullName %></td>
          <td class="py-3 px-4 
            <% if(order.status === 'progress') { %> text-green-500 <% } %>
            <% if(order.status === 'pending') { %> text-yellow-500 <% } %>
            <% if(order.status === 'cancelled') { %> text-red-500 <% } %>
            <% if(order.status === 'completed') { %> text-blue-500 <% } %>
            <% if(order.status === 'delivered') { %> text-teal-500 <% } %>
          "><%= order.status %></td>
          <td class="py-3 px-4">ETB <%= order.totalPrice %></td>
          <td class="py-3 px-4"><%= order.date %></td>
        </tr>
      <% }) %>
    </tbody>
  </table>
</div>

  <script>
    // Initialize AOS (for animations)
    AOS.init();

    const weekData = {
      labels: ['Item 1', 'Item 2', 'Item 3', 'Item 4'],
      datasets: [{
        data: [30, 20, 25, 25],
        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#FF5733'],
        hoverBackgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#FF5733'],
      }]
    };

    const monthData = {
      labels: ['Item 1', 'Item 2', 'Item 3', 'Item 4'],
      datasets: [{
        data: [50, 20, 15, 15],
        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#FF5733'],
        hoverBackgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#FF5733'],
      }]
    };
    // Sample Data for Line Charts and Bar Charts (Replace with actual data)
    const dailyRevenueData = {
      labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri'],
      datasets: [{
        label: 'Revenue (ETB)',
        data: [50, 70, 40, 90, 80],
        borderColor: '#FF6384',
        backgroundColor: 'rgba(255, 99, 132, 0.2)',
        fill: true,
      }]
    };

    const monthlyRevenueData = {
      labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
      datasets: [{
        label: 'Revenue (ETB)',
        data: [200, 220, 180, 250],
        borderColor: '#36A2EB',
        backgroundColor: 'rgba(54, 162, 235, 0.2)',
        fill: true,
      }]
    };

    const dailyOrderStatusData = {
      labels: ['Pending', 'In Progress', 'Completed', 'Cancelled'],
      datasets: [{
        label: 'Orders',
        data: [10, 5, 8, 3],
        backgroundColor: '#FF6384',
        borderColor: '#FF6384',
        borderWidth: 1,
      }]
    };

    const monthlyOrderStatusData = {
      labels: ['Pending', 'In Progress', 'Completed', 'Cancelled'],
      datasets: [{
        label: 'Orders',
        data: [40, 20, 25, 15],
        backgroundColor: '#36A2EB',
        borderColor: '#36A2EB',
        borderWidth: 1,
      }]
    };

    const dailyOrderCountData = {
      labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri'],
      datasets: [{
        label: 'Orders',
        data: [10, 12, 8, 14, 16],
        backgroundColor: '#FFCE56',
        borderColor: '#FFCE56',
        borderWidth: 1,
      }]
    };

    const monthlyOrderCountData = {
      labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
      datasets: [{
        label: 'Orders',
        data: [45, 60, 55, 70],
        backgroundColor: '#FF5733',
        borderColor: '#FF5733',
        borderWidth: 1,
      }]
    };

    // Options for all charts
    const chartOptions = {
      responsive: true,
      plugins: {
        legend: {
          position: 'top',
        },
      },
    };
 
    // Create the Week Pie Chart
    new Chart(document.getElementById('weekPieChart'), {
      type: 'pie',
      data: weekData,
      options: chartOptions,
    });

    // Create the Month Pie Chart
    new Chart(document.getElementById('monthPieChart'), {
      type: 'pie',
      data: monthData,
      options: chartOptions,
    });
    // Create the Revenue Line Charts
    new Chart(document.getElementById('dailyRevenueLineChart'), {
      type: 'line',
      data: dailyRevenueData,
      options: chartOptions,
    });

    new Chart(document.getElementById('monthlyRevenueLineChart'), {
      type: 'line',
      data: monthlyRevenueData,
      options: chartOptions,
    });

    // Create the Order Status Bar Charts
    new Chart(document.getElementById('dailyOrderStatusBarChart'), {
      type: 'bar',
      data: dailyOrderStatusData,
      options: chartOptions,
    });

    new Chart(document.getElementById('monthlyOrderStatusBarChart'), {
      type: 'bar',
      data: monthlyOrderStatusData,
      options: chartOptions,
    });

    // Create the Order Count Bar Charts
    new Chart(document.getElementById('dailyOrderCountBarChart'), {
      type: 'bar',
      data: dailyOrderCountData,
      options: chartOptions,
    });

    new Chart(document.getElementById('monthlyOrderCountBarChart'), {
      type: 'bar',
      data: monthlyOrderCountData,
      options: chartOptions,
    });
  </script>

</body>
</html>
